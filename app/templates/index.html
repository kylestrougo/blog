<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Notebook Blog</title>
<link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&display=swap" rel="stylesheet">

<style>
:root{
  --line-height: clamp(28px, 3vw, 44px);
  --margin-line: clamp(40px, 5vw, 80px);
}

*{box-sizing:border-box;margin:0;padding:0}
body{
  background:#e8eaf0;
  font-family: 'Comic Neue', cursive;
  margin:0;
}

.notebook{
  position: relative; /* ‚úÖ now doodles anchor to notebook */
  width:100%;
  min-height:100vh;
  background:
    linear-gradient(90deg, transparent var(--margin-line),
      rgba(255,98,98,0.15) calc(var(--margin-line) + 2px),
      transparent calc(var(--margin-line) + 4px)),
    repeating-linear-gradient(180deg, rgba(0,85,160,0.08),
      rgba(0,85,160,0.08) 2px,
      transparent 2px, transparent var(--line-height)),
    #fdfdfc;
  padding: clamp(20px, 3vw, 32px) clamp(16px, 2vw, 28px);
  max-width: 1000px;
  margin: auto;
}

/* Doodle images */
.doodle-planet {
  position: absolute;
  top: 12px;
  left: 12px;
  width: 95px;
  opacity: 0.8;
  filter: drop-shadow(1px 1px 0 #00000020);
  pointer-events: none;
  transform: rotate(-5deg); /* slight tilt for hand-drawn look */
}

.doodle-mtns {
  position: absolute;
  top: 12px;
  right: 12px;
  width: 100px;
  opacity: 0.85;
  filter: drop-shadow(1px 1px 0 #00000020);
  pointer-events: none;
  transform: rotate(5deg); /* slight opposite tilt */
}

.new-post-btn {
  display: block;
  position: relative;
  padding: 10px 24px;
  font-family: 'Comic Neue', cursive;
  font-size: clamp(14px, 2vw, 22px);
  color: #000;
  background: transparent;
  border: none;
  cursor: pointer;
  margin: 0 auto 24px auto;
  text-decoration: none;
  font-weight: bold;
  width: fit-content;
  z-index: 1;
}

.new-post-btn::before {
  content: "";
  position: absolute;
  top: 50%;
  left: 50%;
  width: 100%;
  height: 70%;
  background: #fffd75; /* yellow highlighter */
  z-index: -1;
  transform: translate(-50%, -50%) rotate(-2deg);
  border-radius: 6px;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
  transition: all 0.2s ease;
}

/* Hover effect: change highlight + text color */
.new-post-btn:hover {
  color: #ff6262;
}

.new-post-btn:hover::before {
  background: #fff176;
  transform: translate(-50%, -50%) rotate(1deg);
}

.post {
  margin: clamp(16px, 2vw, 20px) 0;
  padding-left: calc(var(--margin-line) + 6px);
  position: relative;
}

.latest-post {
  border: 3px solid red;
  padding: 16px;
  border-radius: 12px;
}

.latest-label {
  position: absolute;
  top: -10px;
  left: 0;
  background: red;
  color: white;
  font-weight: bold;
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 14px;
}

.meta {
  margin-bottom: 6px;
}

.username {
  font-size: clamp(16px, 2.5vw, 24px);
  font-weight: bold;
}

.datetime {
  font-size: clamp(12px, 2vw, 18px);
  font-weight: normal;
  margin-top: 2px;
}

/* Date time formatting */
.date-time {
}

.handwritten {
  font-size: clamp(14px, 2vw, 22px);
  line-height: var(--line-height);
  margin: 0;
  white-space: pre-wrap;
  display: flex;
  flex-direction: column;
  justify-content: center;
}

.post-image {
  margin: 12px 0;
  text-align: center;
}

.post-image img {
  max-width: 100%;
  height: auto;
  border-radius: 12px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.15);
}

/* Dynamic user colors from Flask/Jinja */
{% for user, color in user_colors.items() %}
.user-{{ user|lower }} .username,
.user-{{ user|lower }} .datetime,
.user-{{ user|lower }} .handwritten {
  color: {{ color }};
}
{% endfor %}

/* Mobile-specific adjustments */
@media (max-width: 768px) {
  .username {
    font-size: clamp(18px, 3vw, 26px);
  }
  .datetime {
    font-size: clamp(14px, 2.5vw, 20px);
  }
  .handwritten {
    font-size: clamp(16px, 2.5vw, 24px);
  }
  .notebook {
    padding: clamp(24px, 4vw, 36px) clamp(18px, 3vw, 30px);
  }
  .new-post-btn {
    font-size: clamp(16px, 2.5vw, 24px);
    padding: 14px 24px;
  }

  /* ‚úÖ Planet moves to right on mobile */
  .doodle-planet {
    left: auto;
    right: 280px;
    top: 12px;
  }
}
</style>
</head>
<body>
<div class="notebook">
  <!-- Doodles INSIDE notebook -->
  <img src="{{ url_for('static', filename='planet.png') }}" alt="doodle planet" class="doodle-planet">
  <img src="{{ url_for('static', filename='mtns.png') }}" alt="doodle mountains" class="doodle-mtns">

  <!-- New post button centered horizontally -->
  <a href="{{ url_for('post') }}" class="new-post-btn">üñäÔ∏è New Letter</a>

  {% for post in posts %}
    <article class="post user-{{ post.username|lower }} {% if loop.first %}latest-post{% endif %}">
      {% if loop.first %}
        <div class="latest-label">New</div>
      {% endif %}
      <div class="meta">
        <div class="username">{{ post.username }}</div>
<div class="datetime"><span class="date-time">{{ post.created_at.strftime("%B %d, %Y at %-I:%M%p").title().replace('At', 'at').replace('Am', 'am').replace('Pm', 'pm') }}</span></div>      </div>
      <p class="handwritten">{{ post.text }}</p>

      {% if post.image_path %}
        <div class="post-image">
          <img src="{{ url_for('static', filename='uploads/' + post.image_path) }}" alt="Post image for {{ post.username }}">
        </div>
      {% endif %}
    </article>
  {% endfor %}
</div>
</body>
</html>